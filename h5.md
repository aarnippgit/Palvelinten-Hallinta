# h5 Toimiva versio

## x) Lue ja tiivistä.

### Chacon and Straub 2014: Pro Git, 2ed: 1.3 Getting Started - What is Git?

-Git ottaa snapshotin siitä miltä tiedostot sillä hetkellä näyttävät ja tallentaa siitä viittauksen.
-Jos tiedosto ei muutu, sen tilalle tallentuu linkki edelliseen identtiseen jo tallennettuun versioon kyseisestä tiedostosta.
-Lähes kaikki toiminnot lokaaleja, Verkkoyhteys vaaditaan vain lataamaan versio nettiin tai netistä.
-Tarkistussummien käyttö takaa että muutoksia ei tapahdu Gitin tietämättä.
-Yleisesti ottaen vain lisää dataa, peruuttamattomien virheiden teko on vaikeaa etenkin jos pushaa säännöllisesti toiseen repositorioon.

Kolme tilaa:
* Modified - tiedostoa on muokattu mutta ei commitattu tietokantaan
* Staged - tiedosto on merkitty osaksi seuraavaa committia
* Committed - data on tallennettu onnistuneesti paikalliseen tietokantaan


### Gitin käyttö on lähinnä 'git add . && git commit; git pull && git push'. Selitä tuon komennon jokainen osa. Käytä apuna itse valitsemiasi lähteitä ja viittaa niihin.

1. "git add . && git commit" = Lisää kaikki seuraamattomat tiedostot ja muutokset joita ei ole vielä stagettu -> jos se onnistui, tee committi

2. ";" = Erottaa komennot "git add . && git commit" Ja "git pull && git push", toinen osa suoritetaan vasta kun ensimmäinen on valmis

3. "git pull && git push" = Hae muutokset ja yhdistä ne lokaaliin verioon -> jos se onnistui, pushaa muutokset tietokantaan

### Varaston terokarvinen/suolax/ historia, eli loki ja muutokset. Kätevimmin komentokehotteesta 'git clone https://github.com/terokarvinen/suolax.git; cd suolax/; git log --patch --color|less -R'. Wepistäkin saattaa onnistua kliksuttelemalla "Commits".
 
Committeja kahdeksan:

1. Initial commit: Lisää lisenssi ja README.md
2. Lisää iso kirjaimen ja rivin README:hen
3. Lisää hello world moduulin: init.sls ja README:hen ohje komennolle
4. Lisää Makefile ajamaan "hello" tila
5. Lisää "favourites" tilan sekä Makefileen komennon ajamaan sen
6. Lisää asennettavia ohjelmia "favourites" tilaan, lisää top filen jossa kaikki aikaisemmat tilat, muokkaa Makefilen ajamaan top filen yksittäisten tilojen sijaan
7. Poistaa README:stä ohjeita, muokkaa Makefilen komentoa vähentämään outputin määrää
8. Muokkaa README:n ohjeistusta


## Ympäristö:

* Host OS: Windows 11 Home 24H2 26100.6584
* VirtualBox 7.2.2
* Debian 13 Trixie
* Base Memory: 4000 MB
* Processors: 2
* Storage: 60 GB


## a) Online. Tee uusi varasto GitHubiin (tai Gitlabiin tai mihin vain vastaavaan palveluun). Varaston nimessä ja lyhyessä kuvauksessa tulee olla sana "snow". Aiemmin tehty varasto ei kelpaa. (Muista tehdä varastoon tiedostoja luomisvaiheessa, esim README.md ja GNU General Public License 3)



<img width="671" height="488" alt="uusi_repo_on_syntynyt" src="https://github.com/user-attachments/assets/bf1e4a85-13d6-44b7-ba44-c2ae96e6eced" />



## b) Dolly. Kloonaa edellisessä kohdassa tehty uusi varasto itsellesi, tee muutoksia omalla koneella, puske ne palvelimelle, ja näytä, että ne ilmestyvät weppiliittymään.

Kloonasin repositorion komennolla
```
git clone git@github.com:aarnippgit/all-your-snow-are-belong-to-us.git
```

<img width="944" height="136" alt="kloonattu_repo" src="https://github.com/user-attachments/assets/d2486a89-2123-41ae-aaf7-af8bfba816ee" />

Tämän jälkeen avasin README:n ja lisäsin sinne tekstiä.

<img width="801" height="238" alt="muokattu_README" src="https://github.com/user-attachments/assets/25fea2ee-d5fa-4910-bc53-79059bf6ff4e" />

Lisäsin muutokset commitattavaksi ja tarkistin että ne näkyivät siellä:
```
git add .
git status
```
<img width="687" height="167" alt="changes_to_commit" src="https://github.com/user-attachments/assets/85c71112-32b9-4979-bdfa-233c6c35ef64" />

Jonka jälkeen committasin muutokset
```
git commit
```
ja kirjoitin commit viestin:

<img width="680" height="59" alt="commit_info" src="https://github.com/user-attachments/assets/85965adb-083d-4e67-8c06-f40bfd0037e8" />

<img width="221" height="70" alt="commit_msg" src="https://github.com/user-attachments/assets/9603cd98-a0a3-4429-b4ac-298286c7241f" />

Seuraavaksi puskin muutokset palvelimelle komennolla
```
git push
```
<img width="666" height="174" alt="push_pelaa" src="https://github.com/user-attachments/assets/b0853872-c058-4be7-9995-65d87fb9d31b" />

ja päivitin githubin selaimessa nähdäkseni tehdy muutokset.

<img width="667" height="370" alt="muutokset_läpi" src="https://github.com/user-attachments/assets/addc14a9-ac12-45e7-a669-b3f6500da7ee" />

Sieltähän ne löytyivät.

Loin vielä uuden tiedoston snow.md:

<img width="793" height="364" alt="lumi_info" src="https://github.com/user-attachments/assets/02142d43-10ca-4a91-9123-829a4b5e0c95" />
Jonka jälkeen committasin ja puskin tiedoston kuten aiemmin:

```
git add .
git status
git commit
git push
```
<img width="659" height="171" alt="lumi_info_pushed" src="https://github.com/user-attachments/assets/1e4ba56f-78f7-4aee-9694-71f5d4b55158" />

Takistin taas githubista:


<img width="680" height="539" alt="toka_muutos_näkyy" src="https://github.com/user-attachments/assets/2bebf377-11d7-4fb3-95a9-7fdd60859c62" />

Siellä sekin näkyy.

## c) Doh! Tee tyhmä muutos gittiin, älä tee commit:tia. Tuhoa huonot muutokset ‘git reset --hard’. Huomaa, että tässä toiminnossa ei ole peruutusnappia.

HUOM! Tein tämän tehtävän ennen edellisen tehtävän snow_info.md:n lisäämistä. Tämän takia sitä ei ole näkyvillä ruutukaappauksissa.

Aloitin poistamalla tiedoston README.md:

<img width="726" height="343" alt="README_hävis" src="https://github.com/user-attachments/assets/21af262c-8dbe-4c8b-8249-c318097c9a04" />


Palautin tiedostot edellisen committin tilaan komennolla 
```
git reset --hard
```

<img width="736" height="210" alt="äkkiä_sitä_resettiä" src="https://github.com/user-attachments/assets/81dd204e-f5a8-454b-9e35-1498474097eb" />

README.md palasi keskuuteemme, päiväni pelastui.

## d) Tukki. Tarkastele ja selitä varastosi lokia. Tarkista, että nimesi ja sähköpostiosoitteesi näkyy haluamallasi tavalla ja korjaa tarvittaessa.

Avasin lokitiedot komennolla 
```
git log --patch --color
```
Committeja oli yhteensä kolme:

Initial commit jossa luotiin README.md ja lisenssitiedosto:

<img width="644" height="329" alt="initial_commit_log" src="https://github.com/user-attachments/assets/a84213e4-f120-4775-b713-2c9249491458" />


Toinen jossa parannettiin README.md-tiedostoa:

<img width="479" height="305" alt="commit_2_log" src="https://github.com/user-attachments/assets/5129f224-7614-447d-a21b-c12072bb33cb" />


Ja kolmas jossa lisättiin snow_info.md: 

<img width="1054" height="335" alt="commit_3_log" src="https://github.com/user-attachments/assets/0c1e590f-cd33-4d75-851a-f9c7ec15a0fb" />


Nimi ja sposti olivat jo valmiiksi kunnossa:

<img width="993" height="58" alt="git_config_hyvin" src="https://github.com/user-attachments/assets/1a389650-2a61-4f1a-b727-a37c97843ba0" />

## e) Suolattu rakki. Aja Salt-tiloja omasta varastostasi. (Salt tiedostot mistä vain hakemistosta "--file-root teronSaltHakemisto". Esimerkiksi 'sudo salt-call --local --file-root srv/salt/ state.apply', huomaa suhteellinen polku.) 

## Lähteet

https://git-scm.com/book/en/v2

https://git-scm.com/cheat-sheet

https://git-scm.com/book/en/v2/Git-Basics-Recording-Changes-to-the-Repository

https://mywiki.wooledge.org/BashSheet

https://stackoverflow.com/questions/1078920/equivalent-of-more-or-less-command-in-powershell

https://terokarvinen.com/palvelinten-hallinta/#h5-toimiva-versio
