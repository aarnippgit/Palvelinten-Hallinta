# h3 Soitto kotiin

## x) Lue ja tiivistä

### Karvinen 2021: Two Machine Virtual Network With Debian 11 Bullseye and Vagrant

Vagrant:
-Automatisoi VirtualBox-koneiden asennuksen ja SSH-kirjautumisen
-Ei tarvitse graafista käyttöliittymää

Vagrant Windowsille:

[https://developer.hashicorp.com/vagrant/install] - AMD64

-Luo uusi hakemisto projetkille ja tallenna sinne Vagrantfile

-Hostiin voi kirjautua SSH:lla, virtuaalikoneet ovat yhteydessä toisiinsa verkon kautta.

-Vanhojen virtuaalikoneiden tuhoaminen ja uusien luominen helppoa

-Jotkut järjestelmät rajoittaa mitä IP-osoitteita voi valita, virheilmoitus kertoo miltä väliltä voi käyttää

-ipcalc antaa pienimmän ja suurimman käytettävän osoitteen, vaihda IP Vagrantfilessä 


### Karvinen 2018: Salt Quickstart – Salt Stack Master and Slave on Ubuntu Linux
-Asenna Master

-Jos Masterilla on palomuuri, avaa portit 4505/tcp ja 4506/tcp

-Asenna Slave

-Slaven pitää tietää missä Master on, sille voi antaa id:n tai käyttää hostnamea, jokaisen Slaven nimi pitää olla uniikki

-Hyväksy Slaven avain Masterilla

-Aja pari komentoa Masterilla varmistaaksesi että Slavet vastaa


### Karvinen 2023: Salt Vagrant - automatically provision one master and two slaves

Infra as Code - Your wishes as a text file

-Luodaan uusi kansio /srv/salt/*nimi*, sinne sls-tiedosto johon kirjoitetaan koodi


top.sls - What Slave Runs What States

-Top file määrittää mitä tiloja millekin Slavelle ajetaan


## Ympäristö:

* Host OS: Windows 11 Home 24H2 26100.6584
* VirtualBox 7.2.2
* Debian 13 Trixie
* Base Memory: 4000 MB
* Processors: 2
* Storage: 60 GB


## a) Hello Vagrant! Osoita jollain komennolla, että Vagrant on asennettu. Jos et ole vielä asentanut niitä, raportoi myös Vagrant ja VirtualBox asennukset.

Asensin Vagrantin, VirtualBox löytyi jo.

Latasin Vagrantin [täältä](https://developer.hashicorp.com/vagrant/install) (AMD64, kun Windowsilla operoidaan). Ajoin installerin ja käynnistin koneeni uudelleen. Tämän jälkeen vielä testasin Vagrantin olemassaolon Powersellissä komennolla:
```
vagrant --version
```



<img width="384" height="61" alt="Vagrant_asennettu" src="https://github.com/user-attachments/assets/9c20eeb7-4ed1-4a74-972a-649600b43fe0" />

Siellähän se.

## b) Linux Vagrant. Tee Vagrantilla uusi Linux-virtuaalikone.

Tässä tehtävässä avuksi oli Antti Salmisen [raportti](https://oispadotka.wordpress.com/2020/05/12/h6/) Vagrantilla uuden virtuaalikoneen luomisesta, sekä Vagrantin oma [Quick start opas](https://developer.hashicorp.com/vagrant/tutorials/get-started/setup-project).

Loin kansion debianbookworm64 ja siirryin sihen. Loin Vagrantfilen komennolla
 ```
vagrant init debian/bookworm64
```
<img width="623" height="237" alt="Vagrantfile_1" src="https://github.com/user-attachments/assets/579e60a8-76bd-46fb-9745-e27921c57860" />

Vagrantfilessä asetin hostnameksi kone1.

<img width="330" height="292" alt="ensimmäinen_vm_kone1" src="https://github.com/user-attachments/assets/15caec86-c4fc-42b2-b882-1980d6bb8c76" />


Tämän jälkeen käynnistin luomani virtuaalikoneen.
```
vagrant up
```

<img width="827" height="465" alt="kone1_käynnissä" src="https://github.com/user-attachments/assets/415f6ec2-4327-4eae-9675-76286ed14eca" />


Virtuaalikone käynnistyi, kokeilin vielä yhdistää siihen SSH:lla.
```
Vagrant ssh kone1
```

<img width="789" height="194" alt="kone1_ssh_onnistuu" src="https://github.com/user-attachments/assets/f975b30b-cccf-4dcb-839a-8e504cb73a1c" />

Onnistui.

## c) Kaksin kaunihimpi. Tee kahden Linux-tietokoneen verkko Vagrantilla. Osoita, että koneet voivat pingata toisiaan.

## Lähteet

[https://terokarvinen.com/palvelinten-hallinta/]

[https://terokarvinen.com/2021/two-machine-virtual-network-with-debian-11-bullseye-and-vagrant/]

[https://terokarvinen.com/2018/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/]

[https://terokarvinen.com/2023/salt-vagrant/]

[https://oispadotka.wordpress.com/2020/05/12/h6/]

[https://developer.hashicorp.com/vagrant/tutorials/get-started/setup-project]
